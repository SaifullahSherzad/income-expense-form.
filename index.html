<!DOCTYPE html>
<html lang="ps" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¯ 2026 Ú©Ø§Ù„ ÙÙˆØ±Ù…</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Noto+Naskh+Arabic:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { width: 100%; height: 100%; }
        body {
            font-family: 'Inter', 'Noto Naskh Arabic', sans-serif;
            background: linear-gradient(135deg, #0a0515 0%, #020203 40%, #030712 100%);
            color: #f8fafc;
            direction: rtl;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
        }
        .bg-orbs { position: fixed; inset: 0; z-index: 0; overflow: hidden; }
        .orb { position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.4; animation: float 20s ease-in-out infinite; }
        .orb-1 { width: 400px; height: 400px; background: linear-gradient(135deg, #8b5cf6, #3b82f6); top: -200px; right: -200px; }
        .orb-2 { width: 300px; height: 300px; background: linear-gradient(135deg, #ec4899, #f59e0b); bottom: -150px; left: -150px; animation-delay: -5s; }
        @keyframes float { 0%, 100% { transform: translate(0, 0); } 50% { transform: translate(30px, -30px); } }
        .container { max-width: 600px; width: 100%; z-index: 10; position: relative; }
        .glass {
            background: linear-gradient(135deg, rgba(255,255,255,0.12), rgba(255,255,255,0.04));
            border: 1px solid rgba(255,255,255,0.15);
            backdrop-filter: blur(30px);
            border-radius: 24px;
            padding: 30px 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            animation: slideDown 0.6s ease-out;
        }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }
        #authScreen { display: flex; flex-direction: column; gap: 20px; }
        #authScreen.hidden { display: none !important; }
        #formScreen { display: none; }
        #formScreen.show { display: block; }
        .header { text-align: center; margin-bottom: 30px; }
        .header h1 { font-size: 32px; font-weight: 800; background: linear-gradient(to left, #c084fc, #60a5fa); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 10px; }
        .header p { color: #7dd3fc; font-size: 14px; }
        .btn-group { display: flex; flex-direction: column; gap: 12px; }
        button { width: 100%; padding: 14px 24px; border: none; border-radius: 12px; font-size: 16px; font-weight: 700; cursor: pointer; transition: all 0.3s; font-family: inherit; }
        .btn-primary { background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 50%, #8b5cf6 100%); color: white; box-shadow: 0 15px 40px rgba(6,182,212,0.4); }
        .btn-primary:hover { transform: translateY(-3px); }
        .btn-secondary { background: linear-gradient(135deg, rgba(139,92,246,0.25), rgba(59,130,246,0.15)); border: 2px solid rgba(168,85,247,0.5); color: #c084fc; }
        .btn-secondary:hover { border-color: rgba(168,85,247,0.7); }
        .btn-danger { background: linear-gradient(135deg, rgba(239,68,68,0.25), rgba(220,38,38,0.15)); border: 2px solid rgba(252,165,165,0.5); color: #fca5a5; padding: 10px 20px; width: auto; }
        .divider { text-align: center; color: #7dd3fc; font-size: 12px; margin: 15px 0; opacity: 0.7; }
        .info { background: linear-gradient(135deg, rgba(139,92,246,0.1), rgba(59,130,246,0.05)); border: 1px solid rgba(168,85,247,0.2); border-radius: 12px; padding: 12px; font-size: 12px; color: #bae6fd; line-height: 1.6; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #c084fc; font-size: 14px; }
        input, textarea { width: 100%; padding: 12px 16px; background: linear-gradient(135deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02)); border: 2px solid rgba(139,92,246,0.3); border-radius: 10px; color: #f8fafc; font-family: inherit; font-size: 14px; transition: all 0.3s; }
        input:focus, textarea:focus { outline: none; border-color: #a78bfa; background: linear-gradient(135deg, rgba(255,255,255,0.15), rgba(255,255,255,0.08)); box-shadow: 0 0 20px rgba(168,85,247,0.3); }
        textarea { min-height: 100px; resize: vertical; }
        .form-actions { display: flex; gap: 10px; }
        .form-actions button { flex: 1; }
        .logout-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .modal-overlay { position: fixed; inset: 0; background: rgba(10,5,21,0.95); backdrop-filter: blur(30px); display: none; align-items: center; justify-content: center; z-index: 1000; padding: 15px; }
        .modal-overlay.show { display: flex; }
        .modal { max-width: 500px; width: 100%; }
        .toast { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%) translateY(150px); background: rgba(10,11,14,0.95); border: 2px solid rgba(255,255,255,0.1); border-radius: 12px; padding: 16px; z-index: 999; transition: all 0.4s; max-width: 90%; backdrop-filter: blur(20px); }
        .toast.show { transform: translateX(-50%) translateY(0); }
    </style>
</head>
<body>
    <div class="bg-orbs">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
    </div>
    <div class="container">
        <div class="glass">
            <div id="authScreen">
                <div class="header">
                    <h1>ğŸ” Ø¯ 2026 Ú©Ø§Ù„ ÙÙˆØ±Ù…</h1>
                    <p>âœ¨ Ù„Ø§Ú« Ø§Ù† ÛŒØ§ Ù†ÛŒÙˆ Ø§Ú©Ø§Ø¤Ù†Ù¹</p>
                </div>
                <div class="btn-group">
                    <button class="btn-primary" onclick="handleLogin()">ğŸ”“ Ù„Ø§Ú« Ø§Ù†</button>
                    <button class="btn-secondary" onclick="handleSignup()">ğŸ“ Ù†ÛŒÙˆ Ø§Ú©Ø§Ø¤Ù†Ù¹</button>
                </div>
                <div class="divider">â”â”â” Ù…Ø­ÙÙˆØ¸ Ø³ÛŒØ³ØªÙ… â”â”â”</div>
                <div class="info">âœ¨ Netlify Ù…Ø­ÙÙˆØ¸ Ø³ÛŒØ³ØªÙ… - ØªÙ…Ø§Ù… ÚˆÛŒÙ¹Ø§ Ù…Ø­ÙÙˆØ¸ Ø¯ÛŒ</div>
            </div>
            <div id="formScreen">
                <div class="logout-header">
                    <div class="header" style="margin: 0; text-align: right; flex: 1;">
                        <h1 style="font-size: 24px;">ğŸ“‹ Ø­Ø³Ø§Ø¨</h1>
                    </div>
                    <button class="btn-danger" onclick="handleLogout()">ğŸšª Ø®Ø±ÙˆØ¬</button>
                </div>
                <form id="accountForm" onsubmit="handleSubmit(event)">
                    <div class="form-group">
                        <label>ğŸ“… Ù†ÛÙ¼Ù‡</label>
                        <input type="date" id="date" min="2026-01-01" max="2026-12-31" value="2026-01-01" required>
                    </div>
                    <div class="form-group">
                        <label>ğŸ’° Ø¹Ø§Ø¦Ø¯</label>
                        <input type="number" id="income" min="0">
                    </div>
                    <div class="form-group">
                        <label>ğŸ’¸ Ù…ØµØ§Ø±Ù</label>
                        <input type="number" id="expense" min="0">
                    </div>
                    <div class="form-group">
                        <label>ğŸ“ ØªÙØµÛŒÙ„</label>
                        <input type="text" id="detail">
                    </div>
                    <div class="form-group">
                        <label>ğŸ“Œ ÛŒØ§Ø¯Ø§ÚšØª</label>
                        <textarea id="note"></textarea>
                    </div>
                    <button type="submit" class="btn-primary" style="width: 100%;">âœ… Ø°Ø®ÛŒØ±Ù‡</button>
                </form>
            </div>
        </div>
    </div>
    <div class="modal-overlay" id="modalOverlay">
        <div class="glass modal">
            <h2 style="margin-bottom: 20px; color: #c084fc;">âš ï¸ ØªØµØ¯ÛŒÙ‚</h2>
            <div id="modalContent" style="margin-bottom: 20px; padding: 15px; background: rgba(139,92,246,0.1); border-radius: 10px;"></div>
            <div class="form-actions">
                <button class="btn-secondary" onclick="closeModal()">âœï¸ ØªØµØ­ÛŒØ­</button>
                <button class="btn-primary" onclick="confirmSubmit()">âœ“ ØªØ§ÛŒÛŒØ¯</button>
            </div>
        </div>
    </div>
    <div id="toast" class="toast"><div id="toastContent"></div></div>
    <script>
        const GOOGLE_SHEETS_URL = 'https://script.google.com/macros/s/AKfycbxMuzcGNbDxdvzOaOw-n1hY-Mbr2OsxYEBVDqnC2TP35baYP3lkXbo0nyF87LltSVHB/exec';
        let formData = null;

        if (window.netlifyIdentity) {
            console.log('âœ… Netlify Ù„ÙˆÚˆ');
            window.netlifyIdentity.on('init', () => updateUI());
            window.netlifyIdentity.on('login', () => { updateUI(); showToast('âœ¨ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯!', 'success'); });
            window.netlifyIdentity.on('logout', () => updateUI());
            window.netlifyIdentity.init();
        }

        function updateUI() {
            const user = window.netlifyIdentity?.currentUser?.();
            if (user) {
                document.getElementById('authScreen').classList.add('hidden');
                document.getElementById('formScreen').classList.add('show');
            } else {
                document.getElementById('authScreen').classList.remove('hidden');
                document.getElementById('formScreen').classList.remove('show');
            }
        }

        function handleLogin() { if (window.netlifyIdentity) window.netlifyIdentity.open('login'); }
        function handleSignup() { if (window.netlifyIdentity) window.netlifyIdentity.open('signup'); }
        function handleLogout() { if (window.netlifyIdentity) window.netlifyIdentity.logout(); }

        function handleSubmit(e) {
            e.preventDefault();
            const date = document.getElementById('date').value;
            const year = new Date(date).getFullYear();
            if (year !== 2026) {
                showToast('âŒ 2026 ÙÙ‚Ø·!', 'error');
                return;
            }
            const dateParts = date.split('-');
            formData = {
                date: `${dateParts[2]}-${dateParts[1]}-${dateParts[0]}`,
                income: document.getElementById('income').value || '0',
                expense: document.getElementById('expense').value || '0',
                detail: document.getElementById('detail').value || 'Ù†Ø¯ÙŠ',
                note: document.getElementById('note').value || 'Ù†Ø¯ÙŠ'
            };
            showModal();
        }

        function showModal() {
            document.getElementById('modalContent').innerHTML = `
                <p><strong>ğŸ“…:</strong> ${formData.date}</p>
                <p><strong>ğŸ’°:</strong> ${formData.income}</p>
                <p><strong>ğŸ’¸:</strong> ${formData.expense}</p>
                <p><strong>ğŸ“:</strong> ${formData.detail}</p>
                <p><strong>ğŸ“Œ:</strong> ${formData.note}</p>
            `;
            document.getElementById('modalOverlay').classList.add('show');
        }

        function closeModal() { document.getElementById('modalOverlay').classList.remove('show'); }

        async function confirmSubmit() {
            try {
                const params = new URLSearchParams({date: formData.date, income: formData.income, expense: formData.expense, detail: formData.detail, note: formData.note});
                const response = await fetch(`${GOOGLE_SHEETS_URL}?${params}`);
                const result = await response.text();
                if (result.includes('OK:')) {
                    showToast('âœ¨ Ù…Ø­ÙÙˆØ¸!', 'success');
                    document.getElementById('accountForm').reset();
                    document.getElementById('date').value = '2026-01-01';
                    closeModal();
                }
            } catch(e) { showToast('âŒ Ø®Ø±Ø§Ø¨ÛŒ', 'error'); }
        }

        function showToast(msg, type) {
            const t = document.getElementById('toast');
            document.getElementById('toastContent').textContent = msg;
            t.className = `toast ${type} show`;
            setTimeout(() => t.classList.remove('show'), 3000);
        }

        updateUI();
    </script>
</body>
</html>
